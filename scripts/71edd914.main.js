$(".button-collapse").sideNav(),Array.prototype.shuffle=function(){var a,b,c=this.length;if(0==c)return this;for(;--c;)a=Math.floor(Math.random()*(c+1)),b=this[c],this[c]=this[a],this[a]=b;return this};var copyText=function(a){console.log(a),prompt("Copy to clipboard: Ctrl+C, Enter",a)};"undefined"!=typeof cordova&&cordova.plugins&&cordova.plugins.clipboard&&cordova.plugins.clipboard.copy&&(copyText=cordova.plugins.clipboard.copy),angular.module("ninja.shout.lynx.LynxPics",["firebase","ngRoute"]).config(["$routeProvider",function(a){a.when("/home",{templateUrl:"views/home.html",controller:"LynxController"}).when("/feedback",{templateUrl:"views/feedback.html",controller:"FeedbackController"}).when("/about",{templateUrl:"views/about.html"}).otherwise({redirectTo:"/home"})}]).constant("IMAGE_PATTERN",".+\\.(jpe?g|gif|png)$").constant("IMAGE_COUNT",10).service("URL",function(){this.FIREBASE_BASE="https://eakjb-shout-ninja2.firebaseio.com",this.URL_LYNX=this.FIREBASE_BASE+"/lynx/categories/forum"}).factory("API",["$firebaseArray","UTIL","IMAGE_PATTERN","IMAGE_COUNT","URL",function(a,b,c,d,e){var f={},g=new RegExp(c);return f.lynx=a(new Firebase(e.URL_LYNX)),f.allPosts=[],f.allPostsIndex=0,f.posts=[],f.loaded=!1,f.linksLoaded=0,f.lynx.$watch(function(a){if("child_added"===a.event){var b=f.lynx.$getRecord(a.key);g.test(b.url)&&f.allPosts.push(b),f.linksLoaded++}}),f.lynx.$loaded(function(){f.allPosts.shuffle(),f.validateAndAddImage=function(){var a=f.allPosts[++f.allPostsIndex];b.isImage(a.url).then(function(b){b?f.posts.push(a):f.allPostsIndex<f.allPosts.length&&f.validateAndAddImage()})};for(var a=0;d>a&&f.allPostsIndex<f.allPosts.length;a++)setTimeout(f.validateAndAddImage,0);f.loaded=!0}),f}]).service("UTIL",["$q",function(a){this.isImage=function(b){var c=a.defer(),d=new Image;return d.onerror=function(){c.resolve(!1)},d.onload=function(){c.resolve(!0)},d.src=b,c.promise}}]).controller("NavController",["$scope","$location",function(a,b){a.location=b}]).controller("LynxController",["$scope","API",function(a,b){a.API=b,a.copyText=copyText,a.getGifPath=function(){return"images/loading_gifs/gif"+Math.floor(3*Math.random()+1)+".gif"},jQuery(function(a){a(".scrollable-area").on("scroll",function(){a(this).scrollTop()+a(this).innerHeight()>=this.scrollHeight-512&&b.validateAndAddImage()})})}]).controller("PostController",["$rootScope","$scope","API",function(a,b,c){b.voteClicked=!1,b.votePost=function(d){b.voteClicked=!0,d.submissions||(d.submissions=1),d.submissions++,c.lynx.$save(d),setTimeout(function(){a.$apply(function(){b.voteClicked=!1})},300)}}]).controller("FeedbackController",["$scope","$rootScope",function(a,b){a.data={},a.sent=!1,a.submitForm=function(){$.ajax({url:"//formspree.io/info@shout.ninja",method:"POST",data:a.data,dataType:"json"}).success(function(){b.$apply(function(){a.sent=!0}),Materialize.toast("Feedback Sent.",1e3)}).error(function(){Materialize.toast("Error Submitting Feedback.",1e3)})}}]);